{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/taru/FindMyProf/find-my-prof/app/student/register/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\nexport default function StudentRegister() {\r\n  const router = useRouter();\r\n\r\n  const [form, setForm] = useState({\r\n    name: \"\",\r\n    email: \"\",\r\n    department: \"\",\r\n    year: \"\",\r\n    password: \"\",\r\n    otp: \"\",\r\n  });\r\n\r\n  const [otpSent, setOtpSent] = useState(false);\r\n  const [sendLoading, setSendLoading] = useState(false);\r\n  const [verifyLoading, setVerifyLoading] = useState(false);\r\n  const [emailError, setEmailError] = useState(\"\");\r\n\r\n  const [alert, setAlert] = useState({\r\n    type: \"\", // success | error | warning\r\n    message: \"\",\r\n    show: false,\r\n  });\r\n\r\n  const showAlert = (type: string, message: string) => {\r\n    setAlert({ type, message, show: true });\r\n\r\n    // Auto hide after 3 seconds\r\n    setTimeout(() => {\r\n      setAlert({ type: \"\", message: \"\", show: false });\r\n    }, 3000);\r\n  };\r\n\r\n  const [showSuccessModal, setShowSuccessModal] = useState(false);\r\n\r\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const { name, value } = e.target;\r\n\r\n    // Email validation (field-level)\r\n    if (name === \"email\") {\r\n      const domain = value.split(\"@\")[1];\r\n\r\n      if (value && (!domain || !allowedDomains.includes(domain))) {\r\n        setEmailError(\r\n          \"Email must belong to one of these domains: iitb.ac.in, pilani.bits-pilani.ac.in, iitkgp.ac.in\"\r\n        );\r\n      } else {\r\n        setEmailError(\"\");\r\n      }\r\n    }\r\n\r\n    setForm({ ...form, [name]: value });\r\n  };\r\n\r\n  // Save student to LocalStorage\r\n  const saveStudentToLocal = (student: any) => {\r\n    const existing = JSON.parse(localStorage.getItem(\"students\") || \"[]\");\r\n\r\n    if (existing.some((s: any) => s.email === student.email)) {\r\n      return { ok: false, message: \"Email already registered!\" };\r\n    }\r\n\r\n    existing.push({ id: Date.now(), ...student });\r\n    localStorage.setItem(\"students\", JSON.stringify(existing));\r\n    return { ok: true };\r\n  };\r\n\r\n  // SEND OTP\r\n  const sendOtp = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (emailError) {\r\n      showAlert(\r\n        \"error\",\r\n        \"Please enter a valid institute email before proceeding.\"\r\n      );\r\n      return;\r\n    }\r\n    setSendLoading(true);\r\n\r\n    try {\r\n      await fetch(\"/api/send-otp\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ email: form.email }),\r\n      });\r\n\r\n      setOtpSent(true);\r\n      showAlert(\"success\", \"OTP sent to your email!\");\r\n    } catch (error) {\r\n      console.error(\"OTP Error:\", error);\r\n      showAlert(\"error\", \"Failed to send OTP. Try again.\");\r\n    }\r\n\r\n    setSendLoading(false);\r\n  };\r\n\r\n  // VERIFY OTP + REGISTER\r\n  const verifyOtp = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setVerifyLoading(true);\r\n\r\n    try {\r\n      // OTP verification API (UNCHANGED)\r\n      const res = await fetch(\"/api/verify-otp\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ email: form.email, otp: form.otp }),\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (!data.success) {\r\n        showAlert(\"error\", \"Invalid OTP. Please try again.\");\r\n        setVerifyLoading(false);\r\n        return;\r\n      }\r\n\r\n      // Store student in LocalStorage\r\n      const result = saveStudentToLocal({\r\n        name: form.name,\r\n        email: form.email,\r\n        department: form.department,\r\n        year: form.year,\r\n        password: form.password,\r\n      });\r\n\r\n      if (!result.ok) {\r\n        showAlert(\"warning\", result.message ?? \"Unknown error\");\r\n        setVerifyLoading(false);\r\n        return;\r\n      }\r\n\r\n      setShowSuccessModal(true);\r\n    } catch (error) {\r\n      console.error(\"Verification Error:\", error);\r\n      showAlert(\"error\", \"Something went wrong. Try again.\");\r\n    }\r\n\r\n    setVerifyLoading(false);\r\n  };\r\n\r\n  const allowedDomains = [\r\n    \"iitb.ac.in\",\r\n    \"pilani.bits-pilani.ac.in\",\r\n    \"iitkgp.ac.in\",\r\n  ];\r\n\r\n  return (\r\n    <div className=\"bg-gradient-to-r from-indigo-50 to-blue-50 min-h-screen flex flex-col\">\r\n      <header className=\"bg-gradient-to-r from-indigo-600 to-blue-600 text-white text-center py-4 shadow-md\">\r\n        <h1 className=\"text-2xl font-bold\">Student Registration</h1>\r\n      </header>\r\n\r\n      <main className=\"flex-grow flex items-center justify-center p-6\">\r\n        {/* ALERT BOX */}\r\n        <div className=\"absolute top-24 w-full max-w-md mx-auto\">\r\n          {alert.show && (\r\n            <div\r\n              className={`p-3 rounded-lg flex items-center gap-2 text-white shadow-md animate-fadeIn\r\n                ${\r\n                  alert.type === \"success\"\r\n                    ? \"bg-green-600\"\r\n                    : alert.type === \"error\"\r\n                    ? \"bg-red-600\"\r\n                    : \"bg-yellow-500\"\r\n                }\r\n              `}\r\n            >\r\n              {/* ICONS */}\r\n              {alert.type === \"success\" && <span className=\"text-xl\">✔️</span>}\r\n              {alert.type === \"error\" && <span className=\"text-xl\">❌</span>}\r\n              {alert.type === \"warning\" && <span className=\"text-xl\">⚠️</span>}\r\n\r\n              <p className=\"font-medium\">{alert.message}</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {showSuccessModal && (\r\n          <div className=\"fixed inset-0 flex items-center justify-center backdrop-blur-sm bg-black/30 z-50\">\r\n            <div className=\"bg-white rounded-xl p-8 w-[90%] max-w-md text-center shadow-xl animate-fadeIn\">\r\n              <div className=\"flex justify-center mb-4\">\r\n                <div className=\"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center\">\r\n                  <span className=\"text-green-600 text-5xl\">✔</span>\r\n                </div>\r\n              </div>\r\n\r\n              <h2 className=\"text-2xl font-bold text-gray-800 mb-2\">\r\n                Registration Successful!\r\n              </h2>\r\n\r\n              <p className=\"text-gray-600 mb-6\">\r\n                Your account has been created successfully. You can now log in.\r\n              </p>\r\n\r\n              <button\r\n                onClick={() => {\r\n                  setShowSuccessModal(false);\r\n                  router.push(\"/student/login\");\r\n                }}\r\n                className=\"w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700\"\r\n              >\r\n                Continue to Login\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <form\r\n          onSubmit={otpSent ? verifyOtp : sendOtp}\r\n          className=\"bg-white shadow-lg rounded-2xl p-8 w-full max-w-md space-y-6\"\r\n        >\r\n          {/* Name */}\r\n          <div>\r\n            <label className=\"block font-medium mb-1 text-gray-700\">\r\n              Full Name\r\n            </label>\r\n            <input\r\n              name=\"name\"\r\n              type=\"text\"\r\n              value={form.name}\r\n              onChange={handleChange}\r\n              placeholder=\"Enter full name\"\r\n              className=\"w-full border rounded-lg px-3 py-2\"\r\n              required\r\n            />\r\n          </div>\r\n\r\n          {/* Email */}\r\n          <div>\r\n            <label className=\"block font-medium mb-1 text-gray-700\">\r\n              Email\r\n            </label>\r\n\r\n            <input\r\n              name=\"email\"\r\n              type=\"email\"\r\n              value={form.email}\r\n              onChange={handleChange}\r\n              placeholder=\"Enter email\"\r\n              className={`w-full border rounded-lg px-3 py-2 ${\r\n                emailError ? \"border-red-500\" : \"\"\r\n              }`}\r\n              required\r\n            />\r\n\r\n            {emailError && (\r\n              <p className=\"text-red-600 text-sm mt-1\">{emailError}</p>\r\n            )}\r\n          </div>\r\n\r\n          {/* Department */}\r\n          <div>\r\n            <label className=\"block font-medium mb-1 text-gray-700\">\r\n              Department\r\n            </label>\r\n            <input\r\n              name=\"department\"\r\n              type=\"text\"\r\n              value={form.department}\r\n              onChange={handleChange}\r\n              placeholder=\"Enter department\"\r\n              className=\"w-full border rounded-lg px-3 py-2\"\r\n              required\r\n            />\r\n          </div>\r\n\r\n          {/* Year */}\r\n          <div>\r\n            <label className=\"block font-medium mb-1 text-gray-700\">\r\n              Academic Year\r\n            </label>\r\n            <input\r\n              name=\"year\"\r\n              type=\"text\"\r\n              value={form.year}\r\n              onChange={handleChange}\r\n              placeholder=\"e.g. 1st Year\"\r\n              className=\"w-full border rounded-lg px-3 py-2\"\r\n              required\r\n            />\r\n          </div>\r\n\r\n          {/* Password */}\r\n          <div>\r\n            <label className=\"block font-medium mb-1 text-gray-700\">\r\n              Password\r\n            </label>\r\n            <input\r\n              name=\"password\"\r\n              type=\"password\"\r\n              value={form.password}\r\n              onChange={handleChange}\r\n              placeholder=\"Enter password\"\r\n              className=\"w-full border rounded-lg px-3 py-2\"\r\n              required\r\n            />\r\n          </div>\r\n\r\n          {/* Buttons */}\r\n          {!otpSent ? (\r\n            <button\r\n              type=\"submit\"\r\n              className=\"w-full bg-indigo-600 text-white py-2 rounded-lg\"\r\n            >\r\n              {sendLoading ? \"Sending...\" : \"Send OTP\"}\r\n            </button>\r\n          ) : (\r\n            <div className=\"space-y-4\">\r\n              {/* OTP Input */}\r\n              <div>\r\n                <label className=\"block font-medium mb-1 text-gray-700\">\r\n                  Enter OTP\r\n                </label>\r\n                <input\r\n                  name=\"otp\"\r\n                  type=\"text\"\r\n                  value={form.otp}\r\n                  onChange={handleChange}\r\n                  placeholder=\"Enter OTP received\"\r\n                  className=\"w-full border rounded-lg px-3 py-2\"\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              {/* Validate OTP */}\r\n              <button\r\n                type=\"submit\"\r\n                className=\"w-full bg-green-600 text-white py-2 rounded-lg\"\r\n              >\r\n                {verifyLoading\r\n                  ? \"Validating...\"\r\n                  : \"Validate OTP & Complete Registration\"}\r\n              </button>\r\n\r\n              {/* Resend OTP */}\r\n              <button\r\n                type=\"button\"\r\n                onClick={sendOtp}\r\n                className=\"w-full bg-indigo-500 text-white py-2 rounded-lg\"\r\n              >\r\n                {sendLoading ? \"Sending… ⏳\" : \"Resend OTP\"}\r\n              </button>\r\n            </div>\r\n          )}\r\n        </form>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 551, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/taru/FindMyProf/find-my-prof/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0],"debugId":null}}]
}